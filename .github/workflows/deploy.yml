# Nome do nosso workflow. AparecerÃ¡ na aba "Actions" do GitHub.
name: Deploy to GitHub Pages

# Gatilho: Este workflow irÃ¡ rodar toda vez que vocÃª fizer um 'push'
# para a branch 'main'. Se sua branch principal for 'master', troque aqui.
on:
  push:
    branches:
      - master

# PermissÃµes necessÃ¡rias para que a Action possa publicar no GitHub Pages.
permissions:
  contents: read
  pages: write
  id-token: write

# Tarefas (Jobs) que o workflow irÃ¡ executar.
jobs:
  build-and-deploy:
    runs-on: ubuntu-latest # Usar a versÃ£o mais recente do Ubuntu como mÃ¡quina virtual

    steps:
      # 1. Baixa o cÃ³digo do seu repositÃ³rio para a mÃ¡quina virtual
      - name: Checkout ğŸ›ï¸
        uses: actions/checkout@v4

      # 2. Configura o ambiente Node.js na versÃ£o que vocÃª usa (ajuste se necessÃ¡rio)
      - name: Setup Node.js ğŸŸ©
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'

      # 3. Instala as dependÃªncias do projeto
      - name: Install dependencies ğŸ“¦
        run: npm install

      # 4. ConstrÃ³i a aplicaÃ§Ã£o para produÃ§Ã£o. ESTA Ã‰ A PARTE MAIS IMPORTANTE!
      - name: Build ğŸ”¨
        run: npm run build -- --configuration production --base-href /<nome-do-seu-repositorio>/
        # â—â— ATENÃ‡ÃƒO: Troque <nome-do-seu-repositorio> pelo nome exato do seu repo no GitHub!
        # Exemplo: --base-href /meu-painel-admin/

      # 5. Configura o ambiente para a publicaÃ§Ã£o no GitHub Pages
      - name: Setup Pages âš™ï¸
        uses: actions/configure-pages@v4

      # 6. Faz o upload do artefato (a pasta 'dist/') para o GitHub Pages
      - name: Upload artifact â¬†ï¸
        uses: actions/upload-pages-artifact@v3
        with:
          # O caminho para a pasta que foi gerada pelo comando 'build'
          path: ./dist/<nome-do-seu-projeto-angular>/
          # â—â— ATENÃ‡ÃƒO: O Angular cria uma subpasta dentro de 'dist'.
          # Verifique o nome dela no seu arquivo 'angular.json' (geralmente Ã© o nome do projeto)
          # e substitua '<nome-do-seu-projeto-angular>' aqui.

      # 7. Finaliza o deploy, publicando o site
      - name: Deploy to GitHub Pages ğŸš€
        id: deployment
        uses: actions/deploy-pages@v4
